<!doctype html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="//twitter.github.com/bootstrap/assets/css/bootstrap.css">

    <style tyle="text/css">
      #status-cnt { margin-right: 25px; position: absolute; right: 0; top: 40px;}
      #messages { border: 1px solid black; overflow-y: scroll; position: absolute; left: 0; right: 0; bottom: 30px; top: 40px;}
      #controls { position: absolute; bottom: 0; height: 30px; overflow: hidden;
    </style>

    <title>Happy World Chat</title>
  </head>
  <body>
    <h1>Happy World Chat</h1>
    <ol id="messages" class="unstyled"></ol>
    <div id="status-cnt">Status: <span id="status"> Connecting... </span></div>
    <div id="controls">
      <input type="text" autofocus="autofocus" />
      <button type="button">publish</button>
      <button type="button">broadcast</button>
      <button type="button">whisper</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="//code.jquery.com/jquery-latest.js"></script>
    <script src="//jashkenas.github.com/coffee-script/extras/coffee-script.js"></script>
    <script type="text/coffeescript">
      jQuery ($) ->

        $status = $ '#status'
        socket = io.connect()

        socket.on 'connect', ->
          $status.text 'Connected'

        socket.on 'disconnect', ->
          $status.text 'Disconnected'

        socket.on 'reconnecting', (seconds) ->
          $status.text "Reconnecting in #{seconds} seconds"

        socket.on 'reconnect', ->
          $status.text 'Reconnected'

        socket.on 'reconnect_failed', ->
          $status.text 'Failed to reconnect'

        socket.on 'message', (message) ->
          $('<li>').text(message).appendTo $('#messages')

        socket.on 'secret', (message) ->
          console.log message

        $input = $ 'input'

        $('button').click ->
          socket.emit $(this).text(), $input.val()
          $input.val('').focus()

    </script>
  </body>
</html>
