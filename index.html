<!doctype html>
<html>
  <head>
    <title>Happy World Chat</title>
    <link ref="stylesheet" type="text/css" href="//twitter.github.com/bootstrap/assets/css/bootstrap.css" />

    <style tyle="text/css">
      #messages { border: 1px solid black; }
    </style>
  </head>
  <body>
    <h1>Happy World Chat</h1>
    <input type="text" autofocus="autofocus" />
    <ol id="messages"></ol>
    <button type="button">publish</button>
    <button type="button">broadcast</button>
    <button type="button">whisper</button>
    <p>Status: <span id="status"> Connecting... </span></p>
    <script src="/socket.io/socket.io.js"></script>
    <script src="//code.jquery.com/jquery-latest.js"></script>
    <script src="//jashkenas.github.com/coffee-script/extras/coffee-script.js"></script>
    <script type="text/coffeescript">

      jQuery ($) ->

        $status = $ '#status'
        socket = io.connect()

        socket.on 'connect', ->
          $status.text 'Connected'

        socket.on 'disconnect', ->
          $status.text 'Disconnected'

        socket.on 'reconnecting', (seconds) ->
          $status.text "Reconnecting in #{seconds} seconds"

        socket.on 'reconnect', ->
          $status.text 'Reconnected'

        socket.on 'reconnect_failed', ->
          $status.text 'Failed to reconnect'

        socket.on 'message', (message) ->
          $('<li>').text(message).appendTo $('#messages')

        socket.on 'secret', (message) ->
          console.log message

        $input = $ 'input'

        $('button').click ->
          socket.emit $(this).text(), $input.val()
          $input.val('').focus()

    </script>
  </body>
</html>
